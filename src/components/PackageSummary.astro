---
import blem from "blem";
import RepoGithub from "@icons/Github.astro";
import RepoGitlab from "@icons/Gitlab.astro";
import RepoIcon from "@icons/Repo.astro";
import Tag from "@components/Tag.astro";
/*
import type {
  AugmentedPackage as AugmentedPackageProps,
  Tag as TagProps,
} from "@/components/package/types";
*/
const {
  name,
  description,
  published,
  official,
  version,
  repo,
  author,
  // toggleOfficial,
  // togglePublished,
} = Astro.props;
const [repoicon, Icon] = repo.includes("github")
  ? ["github", RepoGithub]
  : repo.includes("gitlab")
    ? ["gitlab", RepoGitlab]
    : ["repo", RepoIcon];

const bem = blem("Package");
---

<div className={bem("")}>
  <header className={bem("header")}>
    <strong className={bem("name")}>{name}</strong>
    {version ? <em className={bem("version")}>v{version}</em> : null}
  </header>
  <div className={bem("content")}>
    {description ? <p className={bem("description")}>{description}</p> : null}
    <a href={repo} className={bem("link", ["repo"])}>
      <Icon className={bem("repo", [repoicon])} />
    </a>
  </div>
  <footer className={bem("footer")}>
    <div className={bem("authorbox")}>
      <a href={`/author/${author}`} className={bem("link", ["author"])}>
        <img
          src={`https://github.com/${author}.png?size=24`}
          className={bem("avatar")}
          alt={author}
          width={24}
          height={24}
        />
        <span className={bem("author-text")}>{author}</span>
      </a>
    </div>
    <div className={bem("tagbox")}>
      {official ? <Tag name="Official" /> : null}
      {published ? <Tag name="Published" /> : null}
    </div>
  </footer>
</div>

<style lang="stylus">
.Package {
  padding: 1rem;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
  position: relative;
  &__link--repo:hover {
    svg {
      fill: var(--color-pink);
    }
  }
  &__version {
    font-size: 0.75rem;
  }
  &__author-text {
    transition: color 0.3s ease-out;
  }
  &__link--author {
    .Package__author-text {
      color: var(--color-fg);
    }
    &:hover {
      .Package__author-text {
        color: var(--color-pink);
      }
    }
  }
  &__repo {
    transition: fill 0.3s ease-out;
    fill: var(--color-fg);
    align-self: center;
    max-width: 1.5rem;
    max-height: 1.5rem;
    width: 1.5rem;
    height: 1.5rem;
  }
  &__content {
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    height: 3rem;
  }
  &__authorbox {
    width: 30%;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
  }
  &__link--author {
    display: flex;
    flex-direction: row;
    font-size: 0.75rem;
    align-items: center;
  }
  &__avatar {
    margin-right: 0.5rem;
  }
  &__header {
    display: flex;
    flex-direction: row;
    width: 100%;
    align-items: center;
    justify-content: space-between;
  }

  &__description {
    font-size: 0.75rem;
    margin: 0;
    padding: 0;
  }
  &__footer {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    width: 100%;
  }
  &__avatar {
    border-radius: 10rem;
    align-self: flex-start;
    border: 1px solid rgba(255, 255, 255, 0.4);
  }
  &__tagbox {
    display: flex;
    flex-direction: row;
    align-self: flex-end;
    width: 10rem;
    justify-content: flex-end;
  }
  &__tag {
    font-family: "Antonio", sans-serif;
    font-size: 0.75rem;
    cursor: pointer;
    text-shadow: 0 1px rgba(255, 255, 255, 0.35);
    padding: 0.25rem 0.5rem 0.35rem;
    background-color: var(--color-fg);
    color: var(--color-bg);
    border-radius: 0.5rem;
    margin-left: 0.5rem;
    transition: background 0.3s ease-out;
    &--published {
      background-color: var(--color-purple);
    }
    &--official {
      background-color: var(--color-yellow);
    }
    &:hover {
      background-color: var(--color-pink);
    }
  }
}

</style>
